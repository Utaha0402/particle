<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>ç›´æ„Ÿã§ã‚ã‹ã‚‹æ€§æ ¼è¨ºæ–­ãƒ‘ã‚ºãƒ«</title>
    <style>
        /* --- CSS: ã‚¹ã‚¿ã‚¤ãƒ«è¨­å®š --- */
        body {
            font-family: 'Hiragino Kaku Gothic Pro', 'Meiryo', sans-serif;
            background-color: #f4f7f6;
            color: #333;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
        }

        #app-container {
            background-color: #ffffff;
            padding: 40px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            width: 100%;
            max-width: 800px;
        }

        h1 {
            color: #4a90e2;
            text-align: center;
            margin-bottom: 30px;
            font-size: 1.8em;
            border-bottom: 3px solid #4a90e2;
            padding-bottom: 10px;
        }

        /* è³ªå•ã‚¨ãƒªã‚¢ */
        #quiz-area {
            text-align: center;
        }

        #question-text {
            font-size: 1.3em;
            margin-bottom: 20px;
            color: #555;
            min-height: 40px;
        }

        /* é¸æŠè‚¢ãƒœã‚¿ãƒ³ã®ã‚³ãƒ³ãƒ†ãƒŠ */
        #options-container {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-top: 20px;
            text-align: left;
        }

        .option-button {
            background-color: #e0eafb;
            color: #4a90e2;
            padding: 15px;
            border: 2px solid #4a90e2;
            border-radius: 10px;
            cursor: pointer;
            font-size: 1em;
            transition: background-color 0.2s, transform 0.2s;
            font-weight: bold;
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 80px; 
            text-align: center;
        }

        .option-button:hover {
            background-color: #4a90e2;
            color: white;
            transform: translateY(-2px);
        }

        /* åˆ¶å¾¡ãƒœã‚¿ãƒ³ (æˆ»ã‚‹/æ¬¡ã¸) */
        #control-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 30px;
        }

        #control-buttons button {
            padding: 10px 20px;
            font-weight: bold;
        }

        #back-button {
            background-color: #f0ad4e;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        #back-button:hover {
            background-color: #ec971f;
        }

        /* çµæœè¡¨ç¤ºã‚¨ãƒªã‚¢ */
        #result-area {
            text-align: center;
            padding: 30px;
            background-color: #f9f9f9;
            border: 1px dashed #4CAF50;
            border-radius: 10px;
        }

        #result-area h2 {
            color: #4CAF50;
            font-size: 2em;
            margin-bottom: 15px;
        }

        #result-type {
            font-size: 1.8em;
            font-weight: bold;
            color: #d9534f;
            margin-bottom: 20px;
        }

        #result-analysis {
            font-size: 1.1em;
            line-height: 1.8;
            text-align: left;
            margin-top: 20px;
        }

        #result-summary {
            margin-bottom: 15px;
            padding: 10px;
            background-color: #e0f2f1;
            border-radius: 5px;
        }

        /* é€²è¡ŒçŠ¶æ³ãƒãƒ¼ */
        #progress-bar {
            height: 10px;
            background-color: #ccc;
            border-radius: 5px;
            margin-bottom: 25px;
            overflow: hidden;
        }

        #progress-fill {
            height: 100%;
            width: 0%;
            background-color: #4CAF50;
            transition: width 0.3s ease-in-out;
        }
    </style>
</head>
<body>

    <div id="app-container">
        <h1>ç›´æ„Ÿã§ã‚ã‹ã‚‹æ€§æ ¼è¨ºæ–­ãƒ‘ã‚ºãƒ«</h1>

        <div id="progress-bar">
            <div id="progress-fill"></div>
        </div>

        <div id="quiz-area">
            <div id="question-text">è¨ºæ–­ã‚’é–‹å§‹ã—ã¾ã™ã€‚ã€Œã‚¹ã‚¿ãƒ¼ãƒˆã€ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦ãã ã•ã„ã€‚</div>
            
            <div id="options-container">
                <button id="start-button" class="option-button" onclick="startQuiz()">è¨ºæ–­ã‚¹ã‚¿ãƒ¼ãƒˆï¼</button>
            </div>
            
            <div id="control-buttons" style="display: none;">
                <button id="back-button" onclick="goBack()">â—€ å‰ã®è³ªå•ã«æˆ»ã‚‹</button>
            </div>
        </div>

        <div id="result-area" style="display: none;">
            <h2>âœ¨ è¨ºæ–­çµæœ âœ¨</h2>
            <div id="result-type"></div>
            <div id="result-summary"></div>
            <div id="result-analysis"></div>
            <button class="option-button" style="margin-top: 20px; width: 100%;" onclick="location.reload()">ã‚‚ã†ä¸€åº¦è¨ºæ–­ã™ã‚‹</button>
        </div>
    </div>

    <script>
        // --- JavaScript: ãƒ­ã‚¸ãƒƒã‚¯è¨­å®š ---

        // DOMè¦ç´ ã®å–å¾—
        const quizArea = document.getElementById('quiz-area');
        const resultArea = document.getElementById('result-area');
        const questionText = document.getElementById('question-text');
        const optionsContainer = document.getElementById('options-container');
        const progressFill = document.getElementById('progress-fill');
        const controlButtons = document.getElementById('control-buttons');
        const backButton = document.getElementById('back-button');
        const resultType = document.getElementById('result-type');
        const resultSummary = document.getElementById('result-summary');
        const resultAnalysis = document.getElementById('result-analysis');

        // è¨ºæ–­ã®è³ªå•ãƒ‡ãƒ¼ã‚¿ (å…¨20å•)
        const questions = [
            { text: "Q1. é€±æœ«ã®è¨ˆç”»ã‚’ç«‹ã¦ã‚‹ã¨ãã€ã©ã¡ã‚‰ã«æƒ¹ã‹ã‚Œã¾ã™ã‹ï¼Ÿ", options: [{ text: "ç¶¿å¯†ãªã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’çµ„ã‚€", value: "S" }, { text: "ä½•ã‚‚æ±ºã‚ãšã«ã€ãã®å ´ã®æ°—åˆ†ã§å‹•ã", value: "I" }] },
            { text: "Q2. å‹äººã¨ã®ä¼šè©±ã§ã¯ã€ã©ã¡ã‚‰ãŒå¤šã„ã§ã™ã‹ï¼Ÿ", options: [{ text: "ç©æ¥µçš„ã«ç™ºè¨€ã—ã€è­°è«–ã‚’ãƒªãƒ¼ãƒ‰ã™ã‚‹", value: "A" }, { text: "èãå½¹ã«å›ã‚Šã€ç™ºè¨€ã¯å¿…è¦ãªæ™‚ã ã‘ã«ã™ã‚‹", value: "R" }] },
            { text: "Q3. æ–°ã—ã„è¶£å‘³ã‚’å§‹ã‚ã‚‹ã¨ãã€ã©ã¡ã‚‰ã«æƒ¹ã‹ã‚Œã¾ã™ã‹ï¼Ÿ", options: [{ text: "åŸºç¤ã‚’ã—ã£ã‹ã‚Šå­¦ã¹ã‚‹å…¥é–€æ›¸", value: "S" }, { text: "ã¨ã‚Šã‚ãˆãšå§‹ã‚ã¦ã€è‡ªåˆ†ã§è©¦è¡ŒéŒ¯èª¤ã™ã‚‹", value: "I" }] },
            { text: "Q4. ãƒˆãƒ©ãƒ–ãƒ«ãŒç™ºç”Ÿã—ãŸã¨ãã€æœ€åˆã«ã™ã‚‹ã“ã¨ã¯ï¼Ÿ", options: [{ text: "ã™ãã«çŠ¶æ³ã‚’æŠŠæ¡ã—ã€å¯¾ç­–ã‚’è¬›ã˜ã‚‹", value: "A" }, { text: "å°‘ã—ç«‹ã¡æ­¢ã¾ã‚Šã€æ·±ãè€ƒãˆã‚‹æ™‚é–“ã‚’æŒã¤", value: "R" }] },
            { text: "Q5. ä»•äº‹ï¼ˆä½œæ¥­ï¼‰ç’°å¢ƒã¯ã€ã©ã¡ã‚‰ãŒå¥½ã¿ã§ã™ã‹ï¼Ÿ", options: [{ text: "æ•´ç†æ•´é “ã•ã‚Œã€è¦–ç•Œã«ãƒã‚¤ã‚ºãŒãªã„", value: "S" }, { text: "ã‚¢ã‚¤ãƒ‡ã‚¢ã‚„è³‡æ–™ãŒåºƒãŒã‚Šã€æ´»ç™ºãªçŠ¶æ…‹", value: "I" }] },
            
            // --- ãƒ‘ã‚ºãƒ«ï¼ˆç›´æ„Ÿï¼‰è¦ç´ ã®å¤šæ§˜åŒ– ---
            // Q6: è¦å‰‡æ€§ã®é€£æƒ³
            { text: "Q6. ã€ç›´æ„Ÿãƒ‘ã‚ºãƒ«ã€‘ã€Œæ˜Ÿã€æœˆã€æ˜Ÿã€æœˆã€æ˜Ÿ...ã€æ¬¡ã«ç¶šãã¨æ€ã†å›³å½¢ã¯ï¼Ÿ", options: [{ text: "æ˜Ÿ", value: "S" }, { text: "å¤ªé™½", value: "I" }] }, 
            // Q7: è‰²ã®å¯¾æ¯”ï¼ˆè«–ç†çš„ãªè‰²ã®è¦å‰‡æ€§ã‹ã€æ„Ÿæƒ…çš„ãªå¥½ã¿ã®è‰²ã‹ï¼‰
            { text: "Q7. ã€ç›´æ„Ÿãƒ‘ã‚ºãƒ«ã€‘ã€Œé’ã€ç·‘ã€é»„ã€æ©™ã€èµ¤...ã€ã¨ç¶šã„ãŸå¾Œã€é•å’Œæ„Ÿãªãæ„Ÿã˜ã‚‹è‰²ã¯ï¼Ÿ", options: [{ text: "ç´«", value: "S" }, { text: "é‡‘è‰²", value: "I" }] }, 
            // Q8: æ•°åˆ—ã®ç›´æ„Ÿçš„ãªç¶šãï¼ˆè«–ç†çš„ãªå·®ã®è¦å‰‡æ€§ã‹ã€æ„Ÿè¦šçš„ãªæ¬¡ã®æ•°å­—ã‹ï¼‰
            { text: "Q8. ã€ç›´æ„Ÿãƒ‘ã‚ºãƒ«ã€‘ã€Œ1, 4, 9, 16...ã€æ¬¡ã«ç¶šãã¨æ€ã†æ•°å­—ã¯ï¼Ÿ", options: [{ text: "25", value: "S" }, { text: "20", value: "I" }] }, 
            // --- ãƒ‘ã‚ºãƒ«ï¼ˆç›´æ„Ÿï¼‰è¦ç´  çµ‚äº† ---

            { text: "Q9. è¨ˆç”»é€šã‚Šã«é€²ã¾ãªã„ã¨ãã€æ°—æŒã¡ã¯ã©ã†ãªã‚Šã¾ã™ã‹ï¼Ÿ", options: [{ text: "ã‚¤ãƒ©ã‚¤ãƒ©ã™ã‚‹ãŒã€ã™ãã«ä¿®æ­£æ¡ˆã‚’è€ƒãˆã‚‹", value: "S" }, { text: "é¢ç™½ãŒã‚‹ã€‚æ–°ã—ã„å±•é–‹ã ã¨å‰å‘ãã«æ‰ãˆã‚‹", value: "I" }] },
            { text: "Q10. æ–°ã—ã„äººã‚’è©•ä¾¡ã™ã‚‹ã¨ãã€ã©ã“ã‚’é‡è¦–ã—ã¾ã™ã‹ï¼Ÿ", options: [{ text: "éå»ã®å®Ÿç¸¾ã¨å…·ä½“çš„ãªã‚¹ã‚­ãƒ«", value: "S" }, { text: "éš ã•ã‚ŒãŸå¯èƒ½æ€§ã‚„æ½œåœ¨çš„ãªæ‰èƒ½", value: "I" }] },
            { text: "Q11. ã‚°ãƒ«ãƒ¼ãƒ—ã®æ±ºå®šã§ã€ã‚ãªãŸã®å½¹å‰²ã¯ï¼Ÿ", options: [{ text: "çµè«–ã‚’å‡ºã—ã€å®Ÿè¡Œã‚’ä¿ƒã™", value: "A" }, { text: "ãƒ¡ãƒ³ãƒãƒ¼ã®æ„è¦‹ã‚’ã¾ã¨ã‚ã€èª¿å’Œã‚’ä¿ã¤", value: "R" }] },
            { text: "Q12. æ„Ÿæƒ…çš„ãªå¯¾ç«‹ãŒèµ·ããŸã¨ãã€ã©ã¡ã‚‰ã‚’é¸ã³ã¾ã™ã‹ï¼Ÿ", options: [{ text: "ã™ãã«ä»‹å…¥ã—ã€å•é¡Œã‚’è§£æ±ºã™ã‚‹", value: "A" }, { text: "ä¸€æ­©å¼•ã„ã¦ã€å†·é™ã«çŠ¶æ³ã‚’åˆ†æã™ã‚‹", value: "R" }] },
            { text: "Q13. å¤±æ•—ã—ãŸã¨ãã€æœ€ã‚‚å¼·ãæ„Ÿã˜ã‚‹ã®ã¯ï¼Ÿ", options: [{ text: "æ¬¡ã¯ã©ã†ã™ã‚‹ã‹ã¨ã„ã†å¯¾ç­–ã®å¿…è¦æ€§", value: "A" }, { text: "ä½•ãŒåŸå› ã ã£ãŸã®ã‹ã¨ã„ã†æ¢æ±‚ã®å¿…è¦æ€§", value: "R" }] },
            { text: "Q14. é€£çµ¡æ‰‹æ®µã¨ã—ã¦ã€ã©ã¡ã‚‰ã‚’å¥½ã¿ã¾ã™ã‹ï¼Ÿ", options: [{ text: "é›»è©±ã‚„ç›´æ¥ä¼šè©± (å³æ™‚æ€§)", value: "A" }, { text: "ãƒ¡ãƒ¼ãƒ«ã‚„ãƒãƒ£ãƒƒãƒˆ (æ–‡ç« ã§ã®æ•´ç†)", value: "R" }] },
            { text: "Q15. å¤¢ã‚„ç›®æ¨™ã‚’èªã‚‹ã¨ãã€ã©ã¡ã‚‰ã®è¦–ç‚¹ãŒå¤šã„ã§ã™ã‹ï¼Ÿ", options: [{ text: "é”æˆã™ã‚‹ãŸã‚ã®å…·ä½“çš„ãªãƒ—ãƒ­ã‚»ã‚¹", value: "S" }, { text: "å®Ÿç¾ã—ãŸã¨ãã®æ„Ÿæƒ…ã‚„ä¸–ç•Œè¦³", value: "I" }] },
            { text: "Q16. äººå‰ã§æ„è¦‹ã‚’è¿°ã¹ã‚‹ã®ã¯å¾—æ„ã§ã™ã‹ï¼Ÿ", options: [{ text: "è‡ªä¿¡ã‚’æŒã£ã¦ã€ã¯ã£ãã‚Šã¨è©±ã™", value: "A" }, { text: "æº–å‚™ãŒã§ãã¦ã„ã‚Œã°è©±ã›ã‚‹ãŒã€ã§ãã‚Œã°é¿ã‘ãŸã„", value: "R" }] },
            { text: "Q17. ç· ã‚åˆ‡ã‚ŠãŒè¿‘ã„ã¨ãã€é›†ä¸­åŠ›ã¯ï¼Ÿ", options: [{ text: "é«˜ã¾ã‚Šã€è¨ˆç”»é€šã‚Šã«åŠ é€Ÿã™ã‚‹", value: "S" }, { text: "ãƒ—ãƒ¬ãƒƒã‚·ãƒ£ãƒ¼ã‚’æ„Ÿã˜ã€æ–°ã—ã„ã‚¢ã‚¤ãƒ‡ã‚¢ã«é€ƒã’ã‚‹", value: "I" }] },
            { text: "Q18. å‹äººã«å¼±éŸ³ã‚’åãã®ã¯å¾—æ„ã§ã™ã‹ï¼Ÿ", options: [{ text: "å•é¡Œè§£æ±ºã®ãŸã‚ã«è©±ã™ã“ã¨ã¯ã‚ã‚‹", value: "A" }, { text: "ã‚ã¾ã‚Šå¾—æ„ã§ã¯ãªãã€è‡ªåˆ†ã§å‡¦ç†ã—ãŸã„", value: "R" }] },
            { text: "Q19. è‡ªåˆ†ã®æ„Ÿæƒ…ã¯ã€æ™®æ®µã©ã†ã§ã™ã‹ï¼Ÿ", options: [{ text: "ä¸€å®šã§ã€ã‚ã¾ã‚Šæ³¢ãŒãªã„", value: "S" }, { text: "è±Šã‹ã§ã€çŠ¶æ³ã«ã‚ˆã£ã¦å¤§ããå¤‰åŒ–ã™ã‚‹", value: "I" }] },
            { text: "Q20. ã‚ãªãŸã®è¡Œå‹•ã®å‹•æ©Ÿã¯ã€ä¸»ã«ã©ã¡ã‚‰ã§ã™ã‹ï¼Ÿ", options: [{ text: "ç›®æ¨™é”æˆã¨åŠ¹ç‡", value: "A" }, { text: "æ¢æ±‚å¿ƒã¨å¥½å¥‡å¿ƒ", value: "R" }] }
        ];

        let currentQuestionIndex = 0; // ç¾åœ¨ã®è³ªå•ç•ªå·
        let userAnswers = [];         // ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®å›ç­”å±¥æ­´ã‚’ä¿å­˜

        // æ€§æ ¼ã‚¿ã‚¤ãƒ—ã¨åˆ†æçµæœã®å®šç¾©
        // è¨ºæ–­çµæœã®ã‚­ãƒ¼ãŒå­˜åœ¨ã—ãªã„ã¨ã„ã†äº‹æ…‹ã‚’é˜²ããŸã‚ã€ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’å›ºå®šã—ã¾ã™ã€‚
        const personalityTypes = {
            "SA_strong": { type: "âœ¨ å®Œç’§ä¸»ç¾©ã®å¸ä»¤å®˜ (The Organized Director)", analysis: "ã‚ãªãŸã¯**è¨ˆç”»æ€§**ã¨**è¡Œå‹•åŠ›**ãŒæ¥µã‚ã¦é«˜ã„ã€ç¨€æœ‰ãªãƒªãƒ¼ãƒ€ãƒ¼ã‚¿ã‚¤ãƒ—ã§ã™ã€‚ç›®æ¨™ã‚’è¨­å®šã—ãŸã‚‰ã€è«–ç†çš„ã‹ã¤è¿…é€Ÿã«å®Ÿè¡Œã«ç§»ã—ã€çµæœã‚’å‡ºã—ã¾ã™ã€‚ãŸã ã—ã€ãã®å³æ ¼ã•ãŒæ™‚ã«å‘¨å›²ã«ãƒ—ãƒ¬ãƒƒã‚·ãƒ£ãƒ¼ã‚’ä¸ãˆã‚‹ã“ã¨ã‚‚ã‚ã‚‹ãŸã‚ã€æŸ”è»Ÿãªå§¿å‹¢ã‚’æ„è­˜ã™ã‚‹ã¨ã€ã•ã‚‰ã«å¤šãã®æ”¯æŒã‚’å¾—ã‚‹ã§ã—ã‚‡ã†ã€‚" },
            "SR_strong": { type: "ğŸ’ ç·»å¯†ãªæˆ¦ç•¥å®¶ (The Detailed Strategist)", analysis: "ã‚ãªãŸã¯**å®‰å®šæ€§**ã‚’åŸºç›¤ã«ã€**æ·±ã„å†…çœ**ã‚’é‡ã­ã¦è¡Œå‹•ã™ã‚‹å­¦è€…è‚Œã®æˆ¦ç•¥å®¶ã§ã™ã€‚æ„Ÿæƒ…ã«æµã•ã‚Œãšã€ãƒªã‚¹ã‚¯ã‚’å¾¹åº•çš„ã«åˆ†æã—ã¦ã‹ã‚‰å‹•ãå‡ºã™ãŸã‚ã€ä¸‹ã—ãŸåˆ¤æ–­ã¯éå¸¸ã«æ­£ç¢ºã§ã™ã€‚ãƒãƒ¼ãƒ ã§ã¯ã€ã‚ãªãŸã®åˆ†æåŠ›ã¨æº–å‚™ã®å‘¨åˆ°ã•ãŒã€ä¸å¯æ¬ ãªå¼·ã¿ã¨ãªã‚Šã¾ã™ã€‚" },
            "IA_strong": { type: "ğŸš€ æƒ…ç†±ã®ã‚¤ãƒãƒ™ãƒ¼ã‚¿ãƒ¼ (The Passionate Innovator)", analysis: "ã‚ãªãŸã¯**ç›´æ„Ÿ**ã¨**è¡Œå‹•åŠ›**ãŒçˆ†ç™ºçš„ã«çµã³ã¤ã„ãŸã€å¤‰åŒ–ã®æ——æŒ¯ã‚Šå½¹ã§ã™ã€‚æ–°ã—ã„ã‚¢ã‚¤ãƒ‡ã‚¢ãŒæ¬¡ã€…ã¨æ¹§ãå‡ºã—ã€ãã‚Œã‚’å®Ÿè¡Œã«ç§»ã™ã‚¨ãƒãƒ«ã‚®ãƒ¼ã‚’æŒã£ã¦ã„ã¾ã™ã€‚é£½ãã£ã½ã•ãŒç‰ã«ç‘•ã§ã™ãŒã€ã‚ãªãŸã®ç™ºæƒ³åŠ›ã¨å®Ÿè¡ŒåŠ›ã¯ã€åœæ»ã—ãŸçŠ¶æ³ã‚’æ‰“ã¡ç ´ã‚‹æœ€å¤§ã®æ­¦å™¨ã¨ãªã‚Šã¾ã™ã€‚" },
            "IR_strong": { type: "ğŸŒŒ å­¤é«˜ã®å¤¢æƒ³å®¶ (The Deep Dreamer)", analysis: "ã‚ãªãŸã¯**ç›´æ„Ÿ**ã‚’ç¾…é‡ç›¤ã«ã€**å†…çœçš„**ãªä¸–ç•Œã‚’æ¢æ±‚ã™ã‚‹å¤¢æƒ³å®¶ã§ã™ã€‚æ—¥å¸¸ã®è£ã«éš ã•ã‚ŒãŸå¯èƒ½æ€§ã‚’è¦‹æŠœãæ‰èƒ½ãŒã‚ã‚Šã€ç‹¬å‰µçš„ãªæ€è€ƒãƒ—ãƒ­ã‚»ã‚¹ã‚’æŒã£ã¦ã„ã¾ã™ã€‚é›†å›£è¡Œå‹•ã‚ˆã‚Šä¸€äººã‚’å¥½ã¿ã¾ã™ãŒã€ãã®ç‹¬è‡ªã®ã‚¢ã‚¤ãƒ‡ã‚¢ã¯ã€ä¸–ç•Œã‚’é™ã‹ã«ã€ã—ã‹ã—ç¢ºå®Ÿã«å¤‰ãˆã¦ã„ãåŠ›ã‚’æŒã£ã¦ã„ã¾ã™ã€‚" },
            "SA_balance": { type: "âš–ï¸ å®Ÿå‹™çš„ãªæ¨é€²è€… (The Practical Mover)", analysis: "ã‚ãªãŸã¯ã€å®‰å®šã‚’æ±‚ã‚ãªãŒã‚‰ã‚‚è¡Œå‹•ã«ç§»ã™**å®Ÿè·µè€…**ã§ã™ã€‚è¨ˆç”»ã¯ç«‹ã¦ã¾ã™ãŒã€çŠ¶æ³ã«å¿œã˜ã¦ä¿®æ­£ã‚’åŠ ãˆã‚‹æŸ”è»Ÿæ€§ã‚’æŒã£ã¦ã„ã¾ã™ã€‚ãƒãƒ©ãƒ³ã‚¹ã®è‰¯ã•ãŒé­…åŠ›ã§ã‚ã‚Šã€å¤šãã®ãƒãƒ¼ãƒ ã§ä¸­æ ¸çš„ãªå½¹å‰²ã‚’æœãŸã—ã¾ã™ã€‚" },
            "SR_balance": { type: "ğŸ•Šï¸ ç©ã‚„ã‹ãªæ¢æ±‚è€… (The Calm Explorer)", analysis: "ã‚ãªãŸã¯ã€å†…çœã‚’é‡è¦–ã—ã¤ã¤ã‚‚ã€å¿…è¦ãªå ´é¢ã§ã¯å®‰å®šçš„ãªè¡Œå‹•ã‚’é¸ã¶**èª¿å’Œå‹**ã§ã™ã€‚æ€¥ãªå¤‰åŒ–ã¯å¥½ã¿ã¾ã›ã‚“ãŒã€ã˜ã£ãã‚Šæ™‚é–“ã‚’ã‹ã‘ã¦ç‰©äº‹ã‚’æ¢æ±‚ã—ã€çŸ¥è­˜ã‚’æ·±ã‚ã¦ã„ãã“ã¨ã‚’å¾—æ„ã¨ã—ã¦ã„ã¾ã™ã€‚äººé–“é–¢ä¿‚ã«ãŠã„ã¦ã‚‚ã€ç©ã‚„ã‹ãªä¿¡é ¼ã‚’ç¯‰ãã¾ã™ã€‚" },
            "IA_balance": { type: "âš¡ æŸ”è»Ÿãªã‚¢ã‚¤ãƒ‡ã‚¢ãƒãƒ³ (The Adaptive Idea Generator)", analysis: "ã‚ãªãŸã¯ã€ç›´æ„Ÿã‚’æ´»ã‹ã—ã¤ã¤ã‚‚ã€é©åˆ‡ãªã‚¿ã‚¤ãƒŸãƒ³ã‚°ã§è¡Œå‹•ã‚’èµ·ã“ã™**æ©Ÿè»¢ã®åˆ©ã**ã‚¿ã‚¤ãƒ—ã§ã™ã€‚æ§˜ã€…ãªã‚¢ã‚¤ãƒ‡ã‚¢ã‚’è©¦ã—ã€å¤±æ•—ã‚’æã‚Œã¾ã›ã‚“ã€‚ã‚ãªãŸã®å‘¨ã‚Šã«ã¯å¸¸ã«æ´»æ°—ãŒã‚ã‚Šã€æ–°ã—ã„ãƒãƒ£ãƒ¬ãƒ³ã‚¸ãŒçµ¶ãˆã¾ã›ã‚“ã€‚" },
            "IR_balance": { type: "ğŸ¨ æ„Ÿå—æ€§è±Šã‹ãªè¡¨ç¾è€… (The Sensitive Creator)", analysis: "ã‚ãªãŸã¯ã€å†…çœã‚’é€šã˜ã¦ç›´æ„Ÿçš„ãªã²ã‚‰ã‚ãã‚’å¾—ã‚‹**æ„Ÿå—æ€§ã®é«˜ã„**ã‚¿ã‚¤ãƒ—ã§ã™ã€‚èŠ¸è¡“çš„ãªã‚»ãƒ³ã‚¹ã‚„ã€äººã®æ°—æŒã¡ã‚’å¯Ÿã™ã‚‹èƒ½åŠ›ã«å„ªã‚Œã¦ã„ã¾ã™ã€‚ç‹¬è‡ªã®è¦–ç‚¹ã‚’æŒã¡ãªãŒã‚‰ã‚‚ã€å‘¨å›²ã®ç©ºæ°—ã‚’èª­ã‚€ã“ã¨ãŒã§ãã‚‹ç¹Šç´°ã•ã‚’æŒã£ã¦ã„ã¾ã™ã€‚" }
        };

        /**
         * è¨ºæ–­é–‹å§‹ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ãŸã¨ãã®å‡¦ç†
         */
        function startQuiz() {
            userAnswers = [];
            currentQuestionIndex = 0;
            displayQuestion();
            controlButtons.style.display = 'flex';
        }

        /**
         * è³ªå•ã¨é¸æŠè‚¢ã‚’DOMã«è¡¨ç¤ºã™ã‚‹
         */
        function displayQuestion() {
            if (currentQuestionIndex >= questions.length) {
                showResult();
                return;
            }

            const q = questions[currentQuestionIndex];
            
            questionText.textContent = `Q${currentQuestionIndex + 1}/${questions.length}. ${q.text}`;
            
            const progress = (currentQuestionIndex / questions.length) * 100;
            progressFill.style.width = `${progress}%`;
            
            optionsContainer.innerHTML = '';

            q.options.forEach(option => {
                const button = document.createElement('button');
                button.className = 'option-button';
                button.textContent = option.text;
                button.onclick = () => handleAnswer(option.value);
                optionsContainer.appendChild(button);
                
                // æ—¢ã«å›ç­”æ¸ˆã¿ã®å ´åˆã¯ã€ãã®ãƒœã‚¿ãƒ³ã‚’ãƒã‚¤ãƒ©ã‚¤ãƒˆ
                if (userAnswers[currentQuestionIndex] === option.value) {
                    button.style.backgroundColor = '#4a90e2';
                    button.style.color = 'white';
                } else {
                    button.style.backgroundColor = '#e0eafb';
                    button.style.color = '#4a90e2';
                }
            });
            
            // æˆ»ã‚‹ãƒœã‚¿ãƒ³ã®è¡¨ç¤º/éè¡¨ç¤ºã‚’åˆ¶å¾¡
            backButton.style.visibility = currentQuestionIndex > 0 ? 'visible' : 'hidden';
        }

        /**
         * ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒå›ç­”ã‚’é¸æŠã—ãŸã¨ãã®å‡¦ç†
         */
        function handleAnswer(value) {
            userAnswers[currentQuestionIndex] = value;
            currentQuestionIndex++;
            displayQuestion();
        }
        
        /**
         * æˆ»ã‚‹ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ãŸã¨ãã®å‡¦ç†
         */
        function goBack() {
            if (currentQuestionIndex > 0) {
                currentQuestionIndex--;
                displayQuestion();
            }
        }

        /**
         * æœ€çµ‚çš„ãªçµæœã‚’è¡¨ç¤ºã™ã‚‹
         */
        function showResult() {
            progressFill.style.width = '100%';
            
            // æœ€çµ‚é›†è¨ˆ
            let score = { S: 0, I: 0, A: 0, R: 0 };
            userAnswers.forEach(answer => {
                score[answer] += 1;
            });

            quizArea.style.display = 'none';
            controlButtons.style.display = 'none';
            resultArea.style.display = 'block';

            // 1. å„è»¸ã®ã‚¹ã‚³ã‚¢ã‚’å–å¾—
            const sScore = score.S;
            const iScore = score.I;
            const aScore = score.A;
            const rScore = score.R;

            const sDominant = sScore - iScore; 
            const aDominant = aScore - rScore; 
            
            // 2. æœ€çµ‚ã‚¿ã‚¤ãƒ—ã‚­ãƒ¼ã®æ±ºå®šãƒ­ã‚¸ãƒƒã‚¯
            let firstAxis = '';
            let secondAxis = '';
            const threshold = 3; // 20å•ä¸­3ç‚¹å·®ã‚’å„ªä½æ€§ã®åŸºæº–ã¨ã™ã‚‹

            // S/Iè»¸ã®åˆ¤å®š
            if (sDominant >= threshold) {
                firstAxis = 'S_strong';
            } else if (sDominant <= -threshold) {
                firstAxis = 'I_strong';
            } else {
                // å·®ãŒå°ã•ã„å ´åˆã€ã‚¹ã‚³ã‚¢ãŒé«˜ã„æ–¹ã‚’ãƒãƒ©ãƒ³ã‚¹å„ªä½ã¨ã™ã‚‹
                firstAxis = (sScore >= iScore ? 'S_balance' : 'I_balance');
            }

            // A/Rè»¸ã®åˆ¤å®š
            if (aDominant >= threshold) {
                secondAxis = 'A_strong';
            } else if (aDominant <= -threshold) {
                secondAxis = 'R_strong';
            } else {
                secondAxis = (aScore >= rScore ? 'A_balance' : 'R_balance');
            }
            
            // 3. æœ€çµ‚ã‚¿ã‚¤ãƒ—ã‚­ãƒ¼ã®çµåˆã¨èª¿æ•´
            let finalKey = '';
            
            // (ä¾‹) S_strong ã¨ A_strong â†’ SA_strong
            // (ä¾‹) S_balance ã¨ A_strong â†’ SA_balance (ãƒãƒ©ãƒ³ã‚¹å‹ã«å¼·ã„è»¸ãŒçµ„ã¿åˆã‚ã•ã‚‹)
            // (ä¾‹) S_balance ã¨ A_balance â†’ SA_balance (ä¸¡æ–¹ãƒãƒ©ãƒ³ã‚¹å‹)
            
            const sOrI = firstAxis.startsWith('S') ? 'S' : 'I';
            const aOrR = secondAxis.startsWith('A') ? 'A' : 'R';
            
            const isStrong = (firstAxis.endsWith('_strong') && secondAxis.endsWith('_strong'));
            const isBalance = (firstAxis.endsWith('_balance') || secondAxis.endsWith('_balance'));

            if (isStrong) {
                finalKey = sOrI + aOrR + '_strong';
            } else if (isBalance) {
                finalKey = sOrI + aOrR + '_balance';
            } else {
                // ä¸‡ãŒä¸€ã€ä¸¡æ–¹ã¨ã‚‚å¼·è»¸ã§ãªãã€ã‹ã¤ä¸¡æ–¹ã¨ã‚‚ãƒãƒ©ãƒ³ã‚¹è»¸ã§ãªã„ (ã‚ã‚Šãˆãªã„ãŒä¿é™º)
                finalKey = sOrI + aOrR + '_balance';
            }

            // 4. çµæœè¡¨ç¤º
            const result = personalityTypes[finalKey];

            // **********************************************
            // ã€ä¿®æ­£ç‚¹ã€‘çµæœãŒå¿…ãšè¡¨ç¤ºã•ã‚Œã‚‹ã‚ˆã†ã«ã€ãƒ­ã‚¸ãƒƒã‚¯ã‚’ç°¡ç•¥åŒ–
            // **********************************************
            // ãƒ­ã‚¸ãƒƒã‚¯ã‚¨ãƒ©ãƒ¼ã§çµæœãŒè¦‹ã¤ã‹ã‚‰ãªã„å ´åˆã‚’æ’é™¤ã™ã‚‹ãŸã‚ã€å¿…ãšå­˜åœ¨ã™ã‚‹ã‚­ãƒ¼ã‚’ç”Ÿæˆã™ã‚‹ã‚ˆã†ã«ã—ãŸã€‚
            // ã¾ãŸã€å¿µã®ç‚ºã€çµæœãŒè¦‹ã¤ã‹ã‚‰ãªã„å ´åˆã®ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ã‚’è¨­å®šã™ã‚‹
            const finalResult = result || personalityTypes['SA_balance'];


            resultType.textContent = finalResult.type;

            resultSummary.innerHTML = `
                <p><strong>ã€å®‰å®š/ç›´æ„Ÿã€‘è»¸:</strong> S (è¨ˆç”»/å®‰å®š) ${sScore}ç‚¹ vs I (ç›´æ„Ÿ/é©æ–°) ${iScore}ç‚¹</p>
                <p><strong>ã€è¡Œå‹•/å†…çœã€‘è»¸:</strong> A (è¡Œå‹•/æ–­è¨€) ${aScore}ç‚¹ vs R (å†…çœ/æ§ãˆã‚) ${rScore}ç‚¹</p>
            `;

            resultAnalysis.innerHTML = `
                <p><strong>ã€${finalResult.type}ã€‘ã®åˆ†æ:</strong></p>
                <p>${finalResult.analysis}</p>
                <p>â€»æœ¬è¨ºæ–­ã¯ã‚¨ãƒ³ã‚¿ãƒ¼ãƒ†ã‚¤ãƒ¡ãƒ³ãƒˆç›®çš„ã§ã™ã€‚ã‚ãªãŸã®æ·±å±¤å¿ƒç†ã‚’æ¢ã‚‹ãƒ’ãƒ³ãƒˆã¨ã—ã¦ãŠæ¥½ã—ã¿ãã ã•ã„ã€‚</p>
            `;
        }

        document.addEventListener('DOMContentLoaded', () => {
             quizArea.style.display = 'block';
             resultArea.style.display = 'none';
        });
    </script>

</body>
</html>
