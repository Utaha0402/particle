<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>水滴パーティクル</title>
    <style>
        body {
            margin: 0;
            overflow: hidden;
            background-color: #0d1a26; /* 暗めの青灰色を背景に */
        }
        canvas {
            display: block;
        }
    </style>
</head>
<body>
    <canvas id="particleCanvas"></canvas>

    <script>
        const canvas = document.getElementById('particleCanvas');
        const ctx = canvas.getContext('2d');

        let width = canvas.width = window.innerWidth;
        let height = canvas.height = window.innerHeight;

        window.addEventListener('resize', () => {
            width = canvas.width = window.innerWidth;
            height = canvas.height = window.innerHeight;
        });

        const particles = [];
        const mouse = {
            x: width / 2,
            y: height / 2
        };

        window.addEventListener('mousemove', (e) => {
            mouse.x = e.clientX;
            mouse.y = e.clientY;

            // マウスの位置から水滴を生成
            for (let i = 0; i < 7; i++) { // 生成数を少し増やす
                particles.push(new Particle(mouse.x, mouse.y));
            }
        });

        // 水滴を定義するクラス
        class Particle {
            constructor(x, y) {
                this.x = x;
                this.y = y;
                // 初期速度：マウスの動きに加えて、下方向への小さな重力成分
                this.vx = (Math.random() - 0.5) * 4; // 左右に少し散る
                this.vy = (Math.random() - 0.5) * 4 - 2; // 上に少し飛んで、重力で落ちるイメージ

                this.radius = Math.random() * 2 + 1; // 小さめの半径
                this.alpha = 1;
                this.life = Math.random() * 80 + 100; // 寿命を少し長めに調整 (80~180フレーム)
                
                // 水滴らしい青系の色
                const hue = 180 + Math.random() * 60; // シアン〜青の範囲
                this.color = `hsl(${hue}, 80%, 60%)`;
                
                this.gravity = 0.08; // 重力加速度
            }

            update() {
                // 重力を適用してvyを変化させる
                this.vy += this.gravity;

                this.x += this.vx;
                this.y += this.vy;

                // 摩擦による減速（今回は少し弱め）
                this.vx *= 0.99;
                this.vy *= 0.99;

                // 寿命に応じて不透明度を下げる
                this.alpha -= 1 / this.life; // 寿命に対して均等にフェードアウト
            }

            draw() {
                ctx.save();
                ctx.globalAlpha = Math.max(0, this.alpha); // alphaが負にならないように
                ctx.fillStyle = this.color;
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.radius, 0, Math.PI * 2);
                ctx.fill();
                ctx.restore();
            }
        }

        function animate() {
            // 前のフレームを少し透明にして残す（水滴の軌跡は短めにするため少し透明度を上げる）
            ctx.fillStyle = 'rgba(13, 26, 38, 0.15)'; // 背景色と合わせた透明な色
            ctx.fillRect(0, 0, width, height);

            for (let i = 0; i < particles.length; i++) {
                const p = particles[i];
                p.update();
                p.draw();

                // 寿命が尽きた、またはキャンバス外に出たパーティクルを削除
                if (p.alpha <= 0 || p.y > height + p.radius) { // 下に落ちきったら削除
                    particles.splice(i, 1);
                    i--;
                }
            }

            requestAnimationFrame(animate);
        }

        animate();
    </script>
</body>
</html>
