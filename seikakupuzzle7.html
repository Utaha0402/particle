<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>ç›´æ„Ÿã§ã‚ã‹ã‚‹æ€§æ ¼è¨ºæ–­ãƒ‘ã‚ºãƒ«</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+JP:wght@400;700&family=Lato:wght@400;700&display=swap" rel="stylesheet">
    <style>
        /* --- CSS: ã‚¹ã‚¿ã‚¤ãƒ«è¨­å®š (ã‚ªãƒ¼ã‚¿ãƒ ãƒ‡ã‚¶ã‚¤ãƒ³ç‰ˆ) --- */
        :root {
            /* ã‚ªãƒ¼ã‚¿ãƒ ç³»ã‚«ãƒ©ãƒ¼ã‚¹ã‚­ãƒ¼ãƒ  */
            --primary-dark: #4A4A4A; /* æ¿ƒã„ãƒãƒ£ã‚³ãƒ¼ãƒ«ã‚°ãƒ¬ãƒ¼ (ãƒ¡ã‚¤ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ) */
            --primary-medium: #795548; /* ãƒ–ãƒ©ã‚¦ãƒ³ (ã‚¢ã‚¯ã‚»ãƒ³ãƒˆã€è¦‹å‡ºã—) */
            --primary-light: #F5EFE6; /* ã‚ªãƒ•ãƒ›ãƒ¯ã‚¤ãƒˆ/ãƒ™ãƒ¼ã‚¸ãƒ¥ (èƒŒæ™¯) */
            --accent-1: #FFB300; /* ãƒã‚¹ã‚¿ãƒ¼ãƒ‰ã‚¤ã‚¨ãƒ­ãƒ¼ (å¼·èª¿ã€é€²è¡Œãƒãƒ¼) */
            --accent-2: #6D4C41; /* ãƒ†ãƒ©ã‚³ãƒƒã‚¿/æ·±ã¿ã®ã‚ã‚‹èµ¤èŒ¶ (ãƒœã‚¿ãƒ³èƒŒæ™¯) */
            --accent-3: #5C6F68; /* ãƒ‡ã‚£ãƒ¼ãƒ—ãƒ•ã‚©ãƒ¬ã‚¹ãƒˆã‚°ãƒªãƒ¼ãƒ³ (çµæœã®æˆåŠŸè‰²) */
            
            --card-background: #FFFFFF; /* ã‚«ãƒ¼ãƒ‰èƒŒæ™¯ */
            --border-color: #D7CCC8; /* è½ã¡ç€ã„ãŸãƒ©ã‚¤ãƒˆãƒ–ãƒ©ã‚¦ãƒ³ */
            --shadow-color: rgba(0, 0, 0, 0.15);
        }

        body {
            font-family: 'Noto Serif JP', serif; /* å’Œé¢¨ã§è½ã¡ç€ã„ãŸãƒ•ã‚©ãƒ³ãƒˆ */
            background-color: var(--primary-light);
            color: var(--primary-dark);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
            box-sizing: border-box;
        }

        #app-container {
            background-color: var(--card-background);
            padding: 40px;
            border-radius: 15px;
            box-shadow: 0 10px 30px var(--shadow-color);
            width: 100%;
            max-width: 800px;
            border: 1px solid var(--border-color);
            transition: all 0.3s ease;
        }

        h1 {
            font-family: 'Lato', sans-serif; /* ã‚¿ã‚¤ãƒˆãƒ«ã¯ãƒ¢ãƒ€ãƒ³ã« */
            color: var(--primary-medium); /* ãƒ–ãƒ©ã‚¦ãƒ³ã®è¦‹å‡ºã— */
            text-align: center;
            margin-bottom: 30px;
            font-size: 2.3em;
            border-bottom: 3px solid var(--primary-medium);
            padding-bottom: 15px;
            letter-spacing: 0.08em;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.05); /* æ§ãˆã‚ãªå½± */
        }

        /* è³ªå•ã‚¨ãƒªã‚¢ */
        #quiz-area {
            text-align: center;
        }

        #question-text {
            font-size: 1.5em;
            margin-bottom: 30px;
            color: var(--primary-dark);
            min-height: 60px; /* é«˜ã•ç¢ºä¿ */
            font-weight: 700;
            line-height: 1.6;
        }

        /* é¸æŠè‚¢ãƒœã‚¿ãƒ³ã®ã‚³ãƒ³ãƒ†ãƒŠ */
        #options-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); /* èª¿æ•´ */
            gap: 20px;
            margin-top: 25px;
            text-align: center;
        }

        .option-button {
            background-color: var(--primary-light); /* èƒŒæ™¯è‰²ã«è–„ã„è‰² */
            color: var(--primary-medium); /* ãƒ–ãƒ©ã‚¦ãƒ³ã®æ–‡å­— */
            padding: 20px; /* ãƒ‘ãƒ‡ã‚£ãƒ³ã‚°ã‚’å¢—ã‚„ã™ */
            border: 2px solid var(--primary-medium);
            border-radius: 10px;
            cursor: pointer;
            font-size: 1.15em;
            transition: all 0.3s ease;
            font-weight: 700;
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 100px;
            box-shadow: 0 3px 8px rgba(0, 0, 0, 0.1);
        }

        .option-button:hover {
            background-color: var(--accent-2); /* ãƒ†ãƒ©ã‚³ãƒƒã‚¿ã« */
            color: var(--card-background); /* ç™½æ–‡å­— */
            transform: translateY(-7px); /* å°‘ã—æµ®ãä¸ŠãŒã‚‹ */
            box-shadow: 0 8px 20px var(--shadow-color);
        }

        /* é¸æŠæ¸ˆã¿ãƒœã‚¿ãƒ³ã®ã‚¹ã‚¿ã‚¤ãƒ« */
        .option-button.selected {
            background-color: var(--accent-2);
            color: var(--card-background);
            border-color: var(--accent-2);
        }

        /* åˆ¶å¾¡ãƒœã‚¿ãƒ³ (æˆ»ã‚‹/æ¬¡ã¸) */
        #control-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 40px;
            padding-top: 25px;
            border-top: 1px dashed var(--border-color); /* ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ€ãƒ¼ */
        }

        #control-buttons button {
            padding: 15px 30px;
            font-weight: 700;
            border-radius: 8px;
            font-size: 1em;
            cursor: pointer;
            transition: background-color 0.2s, transform 0.2s;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }

        #back-button {
            background-color: var(--accent-1); /* ãƒã‚¹ã‚¿ãƒ¼ãƒ‰ã‚¤ã‚¨ãƒ­ãƒ¼ */
            color: var(--primary-dark);
            border: none;
        }

        #back-button:hover {
            background-color: #E5A300; /* å°‘ã—æ¿ƒã„ãƒã‚¹ã‚¿ãƒ¼ãƒ‰ */
            transform: translateY(-2px);
        }

        /* çµæœè¡¨ç¤ºã‚¨ãƒªã‚¢ */
        #result-area {
            text-align: center;
            padding: 35px;
            background-color: var(--primary-light);
            border: 2px solid var(--accent-3); /* ãƒ‡ã‚£ãƒ¼ãƒ—ã‚°ãƒªãƒ¼ãƒ³ */
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.12);
        }

        #result-area h2 {
            font-family: 'Lato', sans-serif;
            color: var(--accent-3);
            font-size: 2.6em;
            margin-bottom: 25px;
            letter-spacing: 0.1em;
        }

        #result-type {
            font-size: 2.2em;
            font-weight: 700;
            color: var(--primary-medium); /* ãƒ–ãƒ©ã‚¦ãƒ³ã§å¼·èª¿ */
            margin-bottom: 30px;
            letter-spacing: 0.07em;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
        }

        #result-summary {
            margin-bottom: 25px;
            padding: 20px;
            background-color: #EFEBE9; /* ãƒ©ã‚¤ãƒˆãƒ–ãƒ©ã‚¦ãƒ³ */
            border-radius: 8px;
            border: 1px solid var(--border-color);
            font-size: 1.1em;
            line-height: 1.8;
            text-align: left;
        }

        #result-analysis {
            font-size: 1.2em;
            line-height: 2; /* è¡Œé–“ã‚’åºƒã‚ã« */
            text-align: left;
            margin-top: 30px;
            color: var(--primary-dark);
        }

        #result-analysis p {
            margin-bottom: 1.2em;
        }

        /* é€²è¡ŒçŠ¶æ³ãƒãƒ¼ */
        #progress-bar {
            height: 14px; /* å°‘ã—å¤ªã */
            background-color: var(--border-color);
            border-radius: 7px;
            margin-bottom: 35px;
            overflow: hidden;
            box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        #progress-fill {
            height: 100%;
            width: 0%;
            background-color: var(--accent-1); /* ãƒã‚¹ã‚¿ãƒ¼ãƒ‰ã‚¤ã‚¨ãƒ­ãƒ¼ */
            border-radius: 7px;
            transition: width 0.4s ease-in-out;
        }

        /* å†è¨ºæ–­ãƒœã‚¿ãƒ³ */
        .restart-button {
            margin-top: 25px !important; /* !important ã§ä¸Šæ›¸ã */
            width: 100%;
            background-color: var(--primary-medium) !important;
            color: var(--card-background) !important;
            border: none !important;
            padding: 18px !important;
            font-size: 1.15em !important;
            font-weight: 700 !important;
            border-radius: 10px !important;
            box-shadow: 0 4px 10px rgba(0,0,0,0.15);
            transition: background-color 0.3s ease, transform 0.2s ease;
        }
        .restart-button:hover {
            background-color: #5D4037 !important; /* å°‘ã—æ¿ƒã„ãƒ–ãƒ©ã‚¦ãƒ³ */
            transform: translateY(-3px) !important;
            box-shadow: 0 6px 15px rgba(0,0,0,0.2);
        }
    </style>
</head>
<body>

    <div id="app-container">
        <h1>ç›´æ„Ÿã§ã‚ã‹ã‚‹æ€§æ ¼è¨ºæ–­ãƒ‘ã‚ºãƒ«</h1>

        <div id="progress-bar">
            <div id="progress-fill"></div>
        </div>

        <div id="quiz-area">
            <div id="question-text">è¨ºæ–­ã‚’é–‹å§‹ã—ã¾ã™ã€‚ã€Œã‚¹ã‚¿ãƒ¼ãƒˆã€ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦ãã ã•ã„ã€‚</div>
            
            <div id="options-container">
                <button id="start-button" class="option-button" onclick="startQuiz()">è¨ºæ–­ã‚¹ã‚¿ãƒ¼ãƒˆï¼</button>
            </div>
            
            <div id="control-buttons" style="display: none;">
                <button id="back-button" onclick="goBack()">â—€ å‰ã®è³ªå•ã«æˆ»ã‚‹</button>
            </div>
        </div>

        <div id="result-area" style="display: none;">
            <h2>âœ¨ è¨ºæ–­çµæœ âœ¨</h2>
            <div id="result-type"></div>
            <div id="result-summary"></div>
            <div id="result-analysis"></div>
            <button class="option-button restart-button" onclick="location.reload()">ã‚‚ã†ä¸€åº¦è¨ºæ–­ã™ã‚‹</button>
        </div>
    </div>

    <script>
        // --- JavaScript: ãƒ­ã‚¸ãƒƒã‚¯è¨­å®š ---

        // DOMè¦ç´ ã®å–å¾—
        const quizArea = document.getElementById('quiz-area');
        const resultArea = document.getElementById('result-area');
        const questionText = document.getElementById('question-text');
        const optionsContainer = document.getElementById('options-container');
        const progressFill = document.getElementById('progress-fill');
        const controlButtons = document.getElementById('control-buttons');
        const backButton = document.getElementById('back-button');
        const resultType = document.getElementById('result-type');
        const resultSummary = document.getElementById('result-summary');
        const resultAnalysis = document.getElementById('result-analysis');

        // è¨ºæ–­ã®è³ªå•ãƒ‡ãƒ¼ã‚¿ (å…¨20å•)
        const questions = [
            { text: "Q1. é€±æœ«ã®è¨ˆç”»ã‚’ç«‹ã¦ã‚‹ã¨ãã€ã©ã¡ã‚‰ã«æƒ¹ã‹ã‚Œã¾ã™ã‹ï¼Ÿ", options: [{ text: "ç¶¿å¯†ãªã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’çµ„ã‚€", value: "S" }, { text: "ä½•ã‚‚æ±ºã‚ãšã«ã€ãã®å ´ã®æ°—åˆ†ã§å‹•ã", value: "I" }] },
            { text: "Q2. å‹äººã¨ã®ä¼šè©±ã§ã¯ã€ã©ã¡ã‚‰ãŒå¤šã„ã§ã™ã‹ï¼Ÿ", options: [{ text: "ç©æ¥µçš„ã«ç™ºè¨€ã—ã€è­°è«–ã‚’ãƒªãƒ¼ãƒ‰ã™ã‚‹", value: "A" }, { text: "èãå½¹ã«å›ã‚Šã€ç™ºè¨€ã¯å¿…è¦ãªæ™‚ã ã‘ã«ã™ã‚‹", value: "R" }] },
            { text: "Q3. æ–°ã—ã„è¶£å‘³ã‚’å§‹ã‚ã‚‹ã¨ãã€ã©ã¡ã‚‰ã«æƒ¹ã‹ã‚Œã¾ã™ã‹ï¼Ÿ", options: [{ text: "åŸºç¤ã‚’ã—ã£ã‹ã‚Šå­¦ã¹ã‚‹å…¥é–€æ›¸", value: "S" }, { text: "ã¨ã‚Šã‚ãˆãšå§‹ã‚ã¦ã€è‡ªåˆ†ã§è©¦è¡ŒéŒ¯èª¤ã™ã‚‹", value: "I" }] },
            { text: "Q4. ãƒˆãƒ©ãƒ–ãƒ«ãŒç™ºç”Ÿã—ãŸã¨ãã€æœ€åˆã«ã™ã‚‹ã“ã¨ã¯ï¼Ÿ", options: [{ text: "ã™ãã«çŠ¶æ³ã‚’æŠŠæ¡ã—ã€å¯¾ç­–ã‚’è¬›ã˜ã‚‹", value: "A" }, { text: "å°‘ã—ç«‹ã¡æ­¢ã¾ã‚Šã€æ·±ãè€ƒãˆã‚‹æ™‚é–“ã‚’æŒã¤", value: "R" }] },
            { text: "Q5. ä»•äº‹ï¼ˆä½œæ¥­ï¼‰ç’°å¢ƒã¯ã€ã©ã¡ã‚‰ãŒå¥½ã¿ã§ã™ã‹ï¼Ÿ", options: [{ text: "æ•´ç†æ•´é “ã•ã‚Œã€è¦–ç•Œã«ãƒã‚¤ã‚ºãŒãªã„", value: "S" }, { text: "ã‚¢ã‚¤ãƒ‡ã‚¢ã‚„è³‡æ–™ãŒåºƒãŒã‚Šã€æ´»ç™ºãªçŠ¶æ…‹", value: "I" }] },
            
            // --- ãƒ‘ã‚ºãƒ«ï¼ˆç›´æ„Ÿï¼‰è¦ç´ ã®å¤šæ§˜åŒ– ---
            { text: "Q6. ã€ç›´æ„Ÿãƒ‘ã‚ºãƒ«ã€‘ã€Œæ˜Ÿã€æœˆã€æ˜Ÿã€æœˆã€æ˜Ÿ...ã€æ¬¡ã«ç¶šãã¨æ€ã†å›³å½¢ã¯ï¼Ÿ", options: [{ text: "æ˜Ÿ", value: "S" }, { text: "å¤ªé™½", value: "I" }] }, 
            { text: "Q7. ã€ç›´æ„Ÿãƒ‘ã‚ºãƒ«ã€‘ã€Œé’ã€ç·‘ã€é»„ã€æ©™ã€èµ¤...ã€ã¨ç¶šã„ãŸå¾Œã€é•å’Œæ„Ÿãªãæ„Ÿã˜ã‚‹è‰²ã¯ï¼Ÿ", options: [{ text: "ç´«", value: "S" }, { text: "é‡‘è‰²", value: "I" }] }, 
            { text: "Q8. ã€ç›´æ„Ÿãƒ‘ã‚ºãƒ«ã€‘ã€Œ1, 4, 9, 16...ã€æ¬¡ã«ç¶šãã¨æ€ã†æ•°å­—ã¯ï¼Ÿ", options: [{ text: "25", value: "S" }, { text: "20", value: "I" }] }, 
            // --- ãƒ‘ã‚ºãƒ«ï¼ˆç›´æ„Ÿï¼‰è¦ç´  çµ‚äº† ---

            { text: "Q9. è¨ˆç”»é€šã‚Šã«é€²ã¾ãªã„ã¨ãã€æ°—æŒã¡ã¯ã©ã†ãªã‚Šã¾ã™ã‹ï¼Ÿ", options: [{ text: "ã‚¤ãƒ©ã‚¤ãƒ©ã™ã‚‹ãŒã€ã™ãã«ä¿®æ­£æ¡ˆã‚’è€ƒãˆã‚‹", value: "S" }, { text: "é¢ç™½ãŒã‚‹ã€‚æ–°ã—ã„å±•é–‹ã ã¨å‰å‘ãã«æ‰ãˆã‚‹", value: "I" }] },
            { text: "Q10. æ–°ã—ã„äººã‚’è©•ä¾¡ã™ã‚‹ã¨ãã€ã©ã“ã‚’é‡è¦–ã—ã¾ã™ã‹ï¼Ÿ", options: [{ text: "éå»ã®å®Ÿç¸¾ã¨å…·ä½“çš„ãªã‚¹ã‚­ãƒ«", value: "S" }, { text: "éš ã•ã‚ŒãŸå¯èƒ½æ€§ã‚„æ½œåœ¨çš„ãªæ‰èƒ½", value: "I" }] },
            { text: "Q11. ã‚°ãƒ«ãƒ¼ãƒ—ã®æ±ºå®šã§ã€ã‚ãªãŸã®å½¹å‰²ã¯ï¼Ÿ", options: [{ text: "çµè«–ã‚’å‡ºã—ã€å®Ÿè¡Œã‚’ä¿ƒã™", value: "A" }, { text: "ãƒ¡ãƒ³ãƒãƒ¼ã®æ„è¦‹ã‚’ã¾ã¨ã‚ã€èª¿å’Œã‚’ä¿ã¤", value: "R" }] },
            { text: "Q12. æ„Ÿæƒ…çš„ãªå¯¾ç«‹ãŒèµ·ããŸã¨ãã€ã©ã¡ã‚‰ã‚’é¸ã³ã¾ã™ã‹ï¼Ÿ", options: [{ text: "ã™ãã«ä»‹å…¥ã—ã€å•é¡Œã‚’è§£æ±ºã™ã‚‹", value: "A" }, { text: "ä¸€æ­©å¼•ã„ã¦ã€å†·é™ã«çŠ¶æ³ã‚’åˆ†æã™ã‚‹", value: "R" }] },
            { text: "Q13. å¤±æ•—ã—ãŸã¨ãã€æœ€ã‚‚å¼·ãæ„Ÿã˜ã‚‹ã®ã¯ï¼Ÿ", options: [{ text: "æ¬¡ã¯ã©ã†ã™ã‚‹ã‹ã¨ã„ã†å¯¾ç­–ã®å¿…è¦æ€§", value: "A" }, { text: "ä½•ãŒåŸå› ã ã£ãŸã®ã‹ã¨ã„ã†æ¢æ±‚ã®å¿…è¦æ€§", value: "R" }] },
            { text: "Q14. é€£çµ¡æ‰‹æ®µã¨ã—ã¦ã€ã©ã¡ã‚‰ã‚’å¥½ã¿ã¾ã™ã‹ï¼Ÿ", options: [{ text: "é›»è©±ã‚„ç›´æ¥ä¼šè©± (å³æ™‚æ€§)", value: "A" }, { text: "ãƒ¡ãƒ¼ãƒ«ã‚„ãƒãƒ£ãƒƒãƒˆ (æ–‡ç« ã§ã®æ•´ç†)", value: "R" }] },
            { text: "Q15. å¤¢ã‚„ç›®æ¨™ã‚’èªã‚‹ã¨ãã€ã©ã¡ã‚‰ã®è¦–ç‚¹ãŒå¤šã„ã§ã™ã‹ï¼Ÿ", options: [{ text: "é”æˆã™ã‚‹ãŸã‚ã®å…·ä½“çš„ãªãƒ—ãƒ­ã‚»ã‚¹", value: "S" }, { text: "å®Ÿç¾ã—ãŸã¨ãã®æ„Ÿæƒ…ã‚„ä¸–ç•Œè¦³", value: "I" }] },
            { text: "Q16. äººå‰ã§æ„è¦‹ã‚’è¿°ã¹ã‚‹ã®ã¯å¾—æ„ã§ã™ã‹ï¼Ÿ", options: [{ text: "è‡ªä¿¡ã‚’æŒã£ã¦ã€ã¯ã£ãã‚Šã¨è©±ã™", value: "A" }, { text: "æº–å‚™ãŒã§ãã¦ã„ã‚Œã°è©±ã›ã‚‹ãŒã€ã§ãã‚Œã°é¿ã‘ãŸã„", value: "R" }] },
            { text: "Q17. ç· ã‚åˆ‡ã‚ŠãŒè¿‘ã„ã¨ãã€é›†ä¸­åŠ›ã¯ï¼Ÿ", options: [{ text: "é«˜ã¾ã‚Šã€è¨ˆç”»é€šã‚Šã«åŠ é€Ÿã™ã‚‹", value: "S" }, { text: "ãƒ—ãƒ¬ãƒƒã‚·ãƒ£ãƒ¼ã‚’æ„Ÿã˜ã€æ–°ã—ã„ã‚¢ã‚¤ãƒ‡ã‚¢ã«é€ƒã’ã‚‹", value: "I" }] },
            { text: "Q18. å‹äººã«å¼±éŸ³ã‚’åãã®ã¯å¾—æ„ã§ã™ã‹ï¼Ÿ", options: [{ text: "å•é¡Œè§£æ±ºã®ãŸã‚ã«è©±ã™ã“ã¨ã¯ã‚ã‚‹", value: "A" }, { text: "ã‚ã¾ã‚Šå¾—æ„ã§ã¯ãªãã€è‡ªåˆ†ã§å‡¦ç†ã—ãŸã„", value: "R" }] },
            { text: "Q19. è‡ªåˆ†ã®æ„Ÿæƒ…ã¯ã€æ™®æ®µã©ã†ã§ã™ã‹ï¼Ÿ", options: [{ text: "ä¸€å®šã§ã€ã‚ã¾ã‚Šæ³¢ãŒãªã„", value: "S" }, { text: "è±Šã‹ã§ã€çŠ¶æ³ã«ã‚ˆã£ã¦å¤§ããå¤‰åŒ–ã™ã‚‹", value: "I" }] },
            { text: "Q20. ã‚ãªãŸã®è¡Œå‹•ã®å‹•æ©Ÿã¯ã€ä¸»ã«ã©ã¡ã‚‰ã§ã™ã‹ï¼Ÿ", options: [{ text: "ç›®æ¨™é”æˆã¨åŠ¹ç‡", value: "A" }, { text: "æ¢æ±‚å¿ƒã¨å¥½å¥‡å¿ƒ", value: "R" }] }
        ];

        let currentQuestionIndex = 0; // ç¾åœ¨ã®è³ªå•ç•ªå·
        let userAnswers = [];         // ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®å›ç­”å±¥æ­´ã‚’ä¿å­˜

        // æ€§æ ¼ã‚¿ã‚¤ãƒ—ã¨åˆ†æçµæœã®å®šç¾©
        const personalityTypes = {
            "SA_strong": { type: "âœ¨ å®Œç’§ä¸»ç¾©ã®å¸ä»¤å®˜ (The Organized Director)", analysis: "ã‚ãªãŸã¯**è¨ˆç”»æ€§**ã¨**è¡Œå‹•åŠ›**ãŒæ¥µã‚ã¦é«˜ã„ã€ç¨€æœ‰ãªãƒªãƒ¼ãƒ€ãƒ¼ã‚¿ã‚¤ãƒ—ã§ã™ã€‚ç›®æ¨™ã‚’è¨­å®šã—ãŸã‚‰ã€è«–ç†çš„ã‹ã¤è¿…é€Ÿã«å®Ÿè¡Œã«ç§»ã—ã€çµæœã‚’å‡ºã—ã¾ã™ã€‚ãŸã ã—ã€ãã®å³æ ¼ã•ãŒæ™‚ã«å‘¨å›²ã«ãƒ—ãƒ¬ãƒƒã‚·ãƒ£ãƒ¼ã‚’ä¸ãˆã‚‹ã“ã¨ã‚‚ã‚ã‚‹ãŸã‚ã€æŸ”è»Ÿãªå§¿å‹¢ã‚’æ„è­˜ã™ã‚‹ã¨ã€ã•ã‚‰ã«å¤šãã®æ”¯æŒã‚’å¾—ã‚‹ã§ã—ã‚‡ã†ã€‚" },
            "SR_strong": { type: "ğŸ’ ç·»å¯†ãªæˆ¦ç•¥å®¶ (The Detailed Strategist)", analysis: "ã‚ãªãŸã¯**å®‰å®šæ€§**ã‚’åŸºç›¤ã«ã€**æ·±ã„å†…çœ**ã‚’é‡ã­ã¦è¡Œå‹•ã™ã‚‹å­¦è€…è‚Œã®æˆ¦ç•¥å®¶ã§ã™ã€‚æ„Ÿæƒ…ã«æµã•ã‚Œãšã€ãƒªã‚¹ã‚¯ã‚’å¾¹åº•çš„ã«åˆ†æã—ã¦ã‹ã‚‰å‹•ãå‡ºã™ãŸã‚ã€ä¸‹ã—ãŸåˆ¤æ–­ã¯éå¸¸ã«æ­£ç¢ºã§ã™ã€‚ãƒãƒ¼ãƒ ã§ã¯ã€ã‚ãªãŸã®åˆ†æåŠ›ã¨æº–å‚™ã®å‘¨åˆ°ã•ãŒã€ä¸å¯æ¬ ãªå¼·ã¿ã¨ãªã‚Šã¾ã™ã€‚" },
            "IA_strong": { type: "ğŸš€ æƒ…ç†±ã®ã‚¤ãƒãƒ™ãƒ¼ã‚¿ãƒ¼ (The Passionate Innovator)", analysis: "ã‚ãªãŸã¯**ç›´æ„Ÿ**ã¨**è¡Œå‹•åŠ›**ãŒçˆ†ç™ºçš„ã«çµã³ã¤ã„ãŸã€å¤‰åŒ–ã®æ——æŒ¯ã‚Šå½¹ã§ã™ã€‚æ–°ã—ã„ã‚¢ã‚¤ãƒ‡ã‚¢ãŒæ¬¡ã€…ã¨æ¹§ãå‡ºã—ã€ãã‚Œã‚’å®Ÿè¡Œã«ç§»ã™ã‚¨ãƒãƒ«ã‚®ãƒ¼ã‚’æŒã£ã¦ã„ã¾ã™ã€‚é£½ãã£ã½ã•ãŒç‰ã«ç‘•ã§ã™ãŒã€ã‚ãªãŸã®ç™ºæƒ³åŠ›ã¨å®Ÿè¡ŒåŠ›ã¯ã€åœæ»ã—ãŸçŠ¶æ³ã‚’æ‰“ã¡ç ´ã‚‹æœ€å¤§ã®æ­¦å™¨ã¨ãªã‚Šã¾ã™ã€‚" },
            "IR_strong": { type: "ğŸŒŒ å­¤é«˜ã®å¤¢æƒ³å®¶ (The Deep Dreamer)", analysis: "ã‚ãªãŸã¯**ç›´æ„Ÿ**ã‚’ç¾…é‡ç›¤ã«ã€**å†…çœçš„**ãªä¸–ç•Œã‚’æ¢æ±‚ã™ã‚‹å¤¢æƒ³å®¶ã§ã™ã€‚æ—¥å¸¸ã®è£ã«éš ã•ã‚ŒãŸå¯èƒ½æ€§ã‚’è¦‹æŠœãæ‰èƒ½ãŒã‚ã‚Šã€ç‹¬å‰µçš„ãªæ€è€ƒãƒ—ãƒ­ã‚»ã‚¹ã‚’æŒã£ã¦ã„ã¾ã™ã€‚é›†å›£è¡Œå‹•ã‚ˆã‚Šä¸€äººã‚’å¥½ã¿ã¾ã™ãŒã€ãã®ç‹¬è‡ªã®ã‚¢ã‚¤ãƒ‡ã‚¢ã¯ã€ä¸–ç•Œã‚’é™ã‹ã«ã€ã—ã‹ã—ç¢ºå®Ÿã«å¤‰ãˆã¦ã„ãåŠ›ã‚’æŒã£ã¦ã„ã¾ã™ã€‚" },
            "SA_balance": { type: "âš–ï¸ å®Ÿå‹™çš„ãªæ¨é€²è€… (The Practical Mover)", analysis: "ã‚ãªãŸã¯ã€å®‰å®šã‚’æ±‚ã‚ãªãŒã‚‰ã‚‚è¡Œå‹•ã«ç§»ã™**å®Ÿè·µè€…**ã§ã™ã€‚è¨ˆç”»ã¯ç«‹ã¦ã¾ã™ãŒã€çŠ¶æ³ã«å¿œã˜ã¦ä¿®æ­£ã‚’åŠ ãˆã‚‹æŸ”è»Ÿæ€§ã‚’æŒã£ã¦ã„ã¾ã™ã€‚ãƒãƒ©ãƒ³ã‚¹ã®è‰¯ã•ãŒé­…åŠ›ã§ã‚ã‚Šã€å¤šãã®ãƒãƒ¼ãƒ ã§ä¸­æ ¸çš„ãªå½¹å‰²ã‚’æœãŸã—ã¾ã™ã€‚" },
            "SR_balance": { type: "ğŸ•Šï¸ ç©ã‚„ã‹ãªæ¢æ±‚è€… (The Calm Explorer)", analysis: "ã‚ãªãŸã¯ã€å†…çœã‚’é‡è¦–ã—ã¤ã¤ã‚‚ã€å¿…è¦ãªå ´é¢ã§ã¯å®‰å®šçš„ãªè¡Œå‹•ã‚’é¸ã¶**èª¿å’Œå‹**ã§ã™ã€‚æ€¥ãªå¤‰åŒ–ã¯å¥½ã¿ã¾ã›ã‚“ãŒã€ã˜ã£ãã‚Šæ™‚é–“ã‚’ã‹ã‘ã¦ç‰©äº‹ã‚’æ¢æ±‚ã—ã€çŸ¥è­˜ã‚’æ·±ã‚ã¦ã„ãã“ã¨ã‚’å¾—æ„ã¨ã—ã¦ã„ã¾ã™ã€‚äººé–“é–¢ä¿‚ã«ãŠã„ã¦ã‚‚ã€ç©ã‚„ã‹ãªä¿¡é ¼ã‚’ç¯‰ãã¾ã™ã€‚" },
            "IA_balance": { type: "âš¡ æŸ”è»Ÿãªã‚¢ã‚¤ãƒ‡ã‚¢ãƒãƒ³ (The Adaptive Idea Generator)", analysis: "ã‚ãªãŸã¯ã€ç›´æ„Ÿã‚’æ´»ã‹ã—ã¤ã¤ã‚‚ã€é©åˆ‡ãªã‚¿ã‚¤ãƒŸãƒ³ã‚°ã§è¡Œå‹•ã‚’èµ·ã“ã™**æ©Ÿè»¢ã®åˆ©ã**ã‚¿ã‚¤ãƒ—ã§ã™ã€‚æ§˜ã€…ãªã‚¢ã‚¤ãƒ‡ã‚¢ã‚’è©¦ã—ã€å¤±æ•—ã‚’æã‚Œã¾ã›ã‚“ã€‚ã‚ãªãŸã®å‘¨ã‚Šã«ã¯å¸¸ã«æ´»æ°—ãŒã‚ã‚Šã€æ–°ã—ã„ãƒãƒ£ãƒ¬ãƒ³ã‚¸ãŒçµ¶ãˆã¾ã›ã‚“ã€‚" },
            "IR_balance": { type: "ğŸ¨ æ„Ÿå—æ€§è±Šã‹ãªè¡¨ç¾è€… (The Sensitive Creator)", analysis: "ã‚ãªãŸã¯ã€å†…çœã‚’é€šã˜ã¦ç›´æ„Ÿçš„ãªã²ã‚‰ã‚ãã‚’å¾—ã‚‹**æ„Ÿå—æ€§ã®é«˜ã„**ã‚¿ã‚¤ãƒ—ã§ã™ã€‚èŠ¸è¡“çš„ãªã‚»ãƒ³ã‚¹ã‚„ã€äººã®æ°—æŒã¡ã‚’å¯Ÿã™ã‚‹èƒ½åŠ›ã«å„ªã‚Œã¦ã„ã¾ã™ã€‚ç‹¬è‡ªã®è¦–ç‚¹ã‚’æŒã¡ãªãŒã‚‰ã‚‚ã€å‘¨å›²ã®ç©ºæ°—ã‚’èª­ã‚€ã“ã¨ãŒã§ãã‚‹ç¹Šç´°ã•ã‚’æŒã£ã¦ã„ã¾ã™ã€‚" }
        };

        /**
         * è¨ºæ–­é–‹å§‹ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ãŸã¨ãã®å‡¦ç†
         */
        function startQuiz() {
            userAnswers = [];
            currentQuestionIndex = 0;
            displayQuestion();
            controlButtons.style.display = 'flex';
        }

        /**
         * è³ªå•ã¨é¸æŠè‚¢ã‚’DOMã«è¡¨ç¤ºã™ã‚‹
         */
        function displayQuestion() {
            if (currentQuestionIndex >= questions.length) {
                showResult();
                return;
            }

            const q = questions[currentQuestionIndex];
            
            questionText.textContent = `Q${currentQuestionIndex + 1}/${questions.length}. ${q.text}`;
            
            const progress = (currentQuestionIndex / questions.length) * 100;
            progressFill.style.width = `${progress}%`;
            
            optionsContainer.innerHTML = '';

            q.options.forEach(option => {
                const button = document.createElement('button');
                button.className = 'option-button';
                button.textContent = option.text;
                button.onclick = () => handleAnswer(option.value);
                optionsContainer.appendChild(button);
                
                // æ—¢ã«å›ç­”æ¸ˆã¿ã®å ´åˆã¯ã€ãã®ãƒœã‚¿ãƒ³ã‚’ãƒã‚¤ãƒ©ã‚¤ãƒˆ
                if (userAnswers[currentQuestionIndex] === option.value) {
                    button.classList.add('selected'); // 'selected' ã‚¯ãƒ©ã‚¹ã‚’è¿½åŠ 
                } else {
                    button.classList.remove('selected'); // 'selected' ã‚¯ãƒ©ã‚¹ã‚’å‰Šé™¤
                }
            });
            
            // æˆ»ã‚‹ãƒœã‚¿ãƒ³ã®è¡¨ç¤º/éè¡¨ç¤ºã‚’åˆ¶å¾¡
            backButton.style.visibility = currentQuestionIndex > 0 ? 'visible' : 'hidden';
        }

        /**
         * ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒå›ç­”ã‚’é¸æŠã—ãŸã¨ãã®å‡¦ç†
         */
        function handleAnswer(value) {
            userAnswers[currentQuestionIndex] = value;
            currentQuestionIndex++;
            displayQuestion();
        }
        
        /**
         * æˆ»ã‚‹ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ãŸã¨ãã®å‡¦ç†
         */
        function goBack() {
            if (currentQuestionIndex > 0) {
                currentQuestionIndex--;
                displayQuestion();
            }
        }

        /**
         * æœ€çµ‚çš„ãªçµæœã‚’è¡¨ç¤ºã™ã‚‹
         */
        function showResult() {
            progressFill.style.width = '100%';
            
            // æœ€çµ‚é›†è¨ˆ
            let score = { S: 0, I: 0, A: 0, R: 0 };
            userAnswers.forEach(answer => {
                score[answer] += 1;
            });

            quizArea.style.display = 'none';
            controlButtons.style.display = 'none';
            resultArea.style.display = 'block';

            // 1. å„è»¸ã®ã‚¹ã‚³ã‚¢ã‚’å–å¾—
            const sScore = score.S;
            const iScore = score.I;
            const aScore = score.A;
            const rScore = score.R;

            const sDominant = sScore - iScore; 
            const aDominant = aScore - rScore; 
            
            // 2. æœ€çµ‚ã‚¿ã‚¤ãƒ—ã‚­ãƒ¼ã®æ±ºå®šãƒ­ã‚¸ãƒƒã‚¯
            let firstAxisPrefix = ''; // 'S' or 'I'
            let secondAxisPrefix = ''; // 'A' or 'R'
            let axisSuffix = ''; // '_strong' or '_balance'

            const threshold = 3; // 20å•ä¸­3ç‚¹å·®ã‚’å„ªä½æ€§ã®åŸºæº–ã¨ã™ã‚‹

            // S/Iè»¸ã®åˆ¤å®š
            if (sDominant >= threshold) {
                firstAxisPrefix = 'S';
            } else if (sDominant <= -threshold) {
                firstAxisPrefix = 'I';
            } else {
                firstAxisPrefix = (sScore >= iScore ? 'S' : 'I'); // åŒç‚¹ã®å ´åˆã¯Sã‚’å„ªå…ˆ
            }

            // A/Rè»¸ã®åˆ¤å®š
            if (aDominant >= threshold) {
                secondAxisPrefix = 'A';
            } else if (aDominant <= -threshold) {
                secondAxisPrefix = 'R';
            } else {
                secondAxisPrefix = (aScore >= rScore ? 'A' : 'R'); // åŒç‚¹ã®å ´åˆã¯Aã‚’å„ªå…ˆ
            }

            // å¼·ã•ã®ã‚µãƒ•ã‚£ãƒƒã‚¯ã‚¹ã‚’æ±ºå®š
            // å°‘ãªãã¨ã‚‚ã©ã¡ã‚‰ã‹ã®è»¸ã§å¼·ã•ãŒé–¾å€¤ã‚’è¶…ãˆã¦ã„ã‚‹å ´åˆã€'strong'ã¨è¦‹ãªã™
            // ãã‚Œä»¥å¤–ã¯'balance'ã¨ã™ã‚‹
            if ((Math.abs(sDominant) >= threshold) && (Math.abs(aDominant) >= threshold)) {
                axisSuffix = '_strong';
            } else {
                axisSuffix = '_balance';
            }
            
            const finalKey = firstAxisPrefix + secondAxisPrefix + axisSuffix;
            
            // 4. çµæœè¡¨ç¤º
            // ãƒ­ã‚¸ãƒƒã‚¯ã«ã‚ˆã£ã¦ç”Ÿæˆã•ã‚ŒãŸfinalKeyãŒå¿…ãšpersonalityTypesã«å­˜åœ¨ã™ã‚‹ã‚ˆã†ã«ä¿è¨¼
            // ãŸã ã—ã€ä¸‡ãŒä¸€ã®ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ã¨ã—ã¦ã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®çµæœã‚‚è¨­å®š
            const result = personalityTypes[finalKey] || personalityTypes['SA_balance'];


            resultType.textContent = result.type;

            resultSummary.innerHTML = `
                <p><strong>ã€å®‰å®š/ç›´æ„Ÿã€‘è»¸:</strong> S (è¨ˆç”»/å®‰å®š) ${sScore}ç‚¹ vs I (ç›´æ„Ÿ/é©æ–°) ${iScore}ç‚¹</p>
                <p><strong>ã€è¡Œå‹•/å†…çœã€‘è»¸:</strong> A (è¡Œå‹•/æ–­è¨€) ${aScore}ç‚¹ vs R (å†…çœ/æ§ãˆã‚) ${rScore}ç‚¹</p>
            `;

            resultAnalysis.innerHTML = `
                <p><strong>ã€${result.type}ã€‘ã®åˆ†æ:</strong></p>
                <p>${result.analysis}</p>
                <p>â€»æœ¬è¨ºæ–­ã¯ã‚¨ãƒ³ã‚¿ãƒ¼ãƒ†ã‚¤ãƒ¡ãƒ³ãƒˆç›®çš„ã§ã™ã€‚ã‚ãªãŸã®æ·±å±¤å¿ƒç†ã‚’æ¢ã‚‹ãƒ’ãƒ³ãƒˆã¨ã—ã¦ãŠæ¥½ã—ã¿ãã ã•ã„ã€‚</p>
            `;
        }

        document.addEventListener('DOMContentLoaded', () => {
             quizArea.style.display = 'block';
             resultArea.style.display = 'none';
        });
    </script>

</body>
</html>
